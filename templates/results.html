<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeScanBuddy</title>

    <!-- http://getbootstrap.com/docs/5.1/ -->
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
    <script crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">


    <link href="/static/styles.css" rel="stylesheet">


    <!-- donut chart js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>


<body>
    <div class="min_height">
        <!-- Header start-->
        <header class="p-3 footer_color start-0 top-0 end-0">
            <div class="d-flex justify-content-between align-items-center">
                <a href="/" class="text-decoration-none text-white fs-5 fw-bold"><img src="/static/favicon.png" class="favicon" alt="Favicon" width="24" height="24">ResumeScanBuddy</a>
            </div>
        </header>
        <!-- Header end-->


        <!-- scan results section start -->
        <section class="container-custom result-text-width text-center results-custom-margin">
            <div>
                <h1 class="h2 mb-5 fw-bold">Your Resume Scan Results</h1>
            </div>
            <div class="row mx-auto justify-content-center pb-3 align-items-center">
                <div class="col-12 col-sm-6 justify-content-center align-items-center ats-donut-width">
                    <div class="justify-content-center align-items-center d-flex">
                        <canvas id="ats-score-chart"></canvas>
                    </div>
                    <div>
                        <h5 class="fw-bold text-center text-black mt-2">Target = 65%</h5>
                    </div>
                </div>

                <!-- ATS Best practices start -->
                <div class="col-12 col-sm-6 justify-content-md-ceneter lead results-quick results-quick-width">
                    <h4 class="fw-bold mb-3">ATS Best Practices</h4>
                    <div>
                        {% if email %}
                        <div class="paragraph">
                            <i class="bi bi-check-lg custom-icon"></i>
                            <span>Email address found</span>
                        </div>
                        {% else %}
                        <div class="paragraph">
                            <i class="bi bi-x-lg custom-icon-1"></i>
                            <span>Email address not found</span>
                        </div>
                        {% endif %}
                        {% if phone_number %}
                        <div class="paragraph">
                            <i class="bi bi-check-lg custom-icon"></i>
                            <span>Phone number found</span>
                        </div>
                        {% else %}
                        <div class="paragraph">
                            <i class="bi bi-x-lg custom-icon-1"></i>
                            <span>Phone number not found</span>
                        </div>
                        {% endif %}
                        {% if linkedin %}
                        <div class="paragraph">
                            <i class="bi bi-check-lg custom-icon"></i>
                            <span>Linkedin profile found</span>
                        </div>
                        {% else %}
                        <div class="paragraph">
                            <i class="bi bi-x-lg custom-icon-1"></i>
                            <span>Linkedin profile not found</span>
                        </div>
                        {% endif %}
                        {% if  word_count_bool %}
                        <div class="paragraph">
                            <i class="bi bi-check-lg custom-icon"></i>
                            <span>Word count is 450 - 750</span>
                        </div>
                        {% else %}
                        <div class="paragraph">
                            <i class="bi bi-x-lg custom-icon-1"></i>
                            <span>Word count not 450 - 750</span>
                        </div>
                        {% endif %}
                    </div>
                    <!-- ATS Best practices end-->
                </div>
            </div>
        </section>
        <!-- scan results section end -->


        <!-- result message section start -->
        <section class="container-custom-results text-center my-4 section-with-border">
            <p class="ats_message_width lead">{{ ats_message }}</p>
            <a href="/" class="custom-scan-now no-underline my-4" role="button">Scan Again</a>
            <br>
            <span>Need help with your resume? Visit <a href="/contact-us">Contact Us</a>.</span>
        </section>
        <!-- result message section end -->
        

        <!-- key word comparison section start -->
        <section class="container-custom alight-items-center justify-content-center my-5 text-center">
            <h4 class="fw-bold mb-4">Key Word Comparison</h4>
            <div>
                <table class="table results-table-width">
                    <thead class="table-header">
                        <tr>
                            <th>Key Word</th>
                            <th>Resume</th>
                            <th>Job Posting</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    {% for index, row in skills_df.iterrows() %}
                        <tr>
                            <td>{{ row['word'] }}</td>
                            <td>{{ row['resume_count'] }}</td>
                            <td>{{ row['job_posting_count'] }}</td>
                            <td {% if row.difference < 0 %} style="color: rgba(255, 0, 0);" {% else %} style="color: rgba(0, 128, 0, 0.8);" {% endif %} class="fw-bold">{{ row['difference'] }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </section>
        <!-- key word comparison section end -->
    </div>

    
    <!-- footer start -->
    <footer class="footer footer_color text-white">
        <div class="container-custom d-flex justify-content-between align-items-center py-3 border-highlight">
            <div class="col-md-4 d-flex align-items-center mx-3">
                <a href="/" class="me-2 text-decoration-none text-white">
                    <span>&copy; 2023 ResumeScanBuddy</span>
                </a>
            </div>
            <div class="col-md-4 right-aligned-text mx-3" >
                <a href="/privacy-policy" class="me-2 text-decoration-none text-white">
                    <span class=>Privacy Policy</span>
                </a>
                <a href="/contact-us" class="me-2 text-decoration-none text-white">
                    <span class=>Contact Us</span>
                </a>
            </div>
        </div>
    </footer>
    <!-- footer end -->


    <script>
        
        const ctx = document.getElementById('ats-score-chart');

        ats_score = "{{ ats_score }}";

        ats_text = ats_score.toString();

        // Define the user's ATS score and calculate the two segments' values
        var userScore = ats_score; // Replace this with the user's ATS score
        var lowerRange = Math.min(userScore, 65);
        var upperRange = Math.max(userScore, 65);

        console.log(ats_score);

        console.log(ats_text);

        Chart.overrides.doughnut.plugins.legend.display = false;
      

        var Chart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: [],
                datasets: [{
                    data: [ats_score, 100 - ats_score],
                    backgroundColor: [
                        'rgba(0, 128, 0, 0.8)', // green
                        'rgba(255, 0, 0, 0.8)' // red
                    ]
                }]
            },
            options: {
                cutoutPercentage: 40,
                responsive: true,
                maintainAspectRatio: false,
                events: [],
                animation: {
                    duration: 2000
                }
            },
            plugins: [{
                beforeDraw: function(chart) {
                    var width = chart.width,
                        height = chart.height,
                        ctx = chart.ctx;
                    ctx.restore();
                    var fontSize = (Math.min(width, height) / 7).toFixed(0);
                    ctx.font = "bold " + fontSize + "px Montserrat";
                    ctx.textBaseline = "middle";
                    var text = ats_score + '%',
                        textX = Math.round((width - ctx.measureText(text).width) / 2),
                        textY = height / 2;
                    ctx.fillText(text, textX, textY);
                    ctx.save();
                }
            }]
        });
    </script>
</body>
</html>
